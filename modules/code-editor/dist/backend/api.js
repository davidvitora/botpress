"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _default = async (bp, editorByBot) => {
  const router = bp.http.createRouterForBot('code-editor');
  router.get('/files', async (req, res) => {
    try {
      res.send((await editorByBot[req.params.botId].fetchFiles()));
    } catch (err) {
      bp.logger.attachError(err).error('Error fetching files');
      res.sendStatus(500);
    }
  });
  router.post('/save', async (req, res) => {
    try {
      await editorByBot[req.params.botId].saveFile(req.body);
      res.sendStatus(200);
    } catch (err) {
      bp.logger.attachError(err).error('Could not save file');
      res.sendStatus(500);
    }
  });
  router.get('/typings', async (req, res) => {
    try {
      res.send((await editorByBot[req.params.botId].loadTypings()));
    } catch (err) {
      bp.logger.attachError(err).error('Could not load typings. Code completion will not be available');
      res.sendStatus(500);
    }
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaS50cyJdLCJuYW1lcyI6WyJicCIsImVkaXRvckJ5Qm90Iiwicm91dGVyIiwiaHR0cCIsImNyZWF0ZVJvdXRlckZvckJvdCIsImdldCIsInJlcSIsInJlcyIsInNlbmQiLCJwYXJhbXMiLCJib3RJZCIsImZldGNoRmlsZXMiLCJlcnIiLCJsb2dnZXIiLCJhdHRhY2hFcnJvciIsImVycm9yIiwic2VuZFN0YXR1cyIsInBvc3QiLCJzYXZlRmlsZSIsImJvZHkiLCJsb2FkVHlwaW5ncyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztlQUllLE9BQU9BLEVBQVAsRUFBdUJDLFdBQXZCLEtBQW9EO0FBQ2pFLFFBQU1DLE1BQU0sR0FBR0YsRUFBRSxDQUFDRyxJQUFILENBQVFDLGtCQUFSLENBQTJCLGFBQTNCLENBQWY7QUFFQUYsRUFBQUEsTUFBTSxDQUFDRyxHQUFQLENBQVcsUUFBWCxFQUFxQixPQUFPQyxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdkMsUUFBSTtBQUNGQSxNQUFBQSxHQUFHLENBQUNDLElBQUosRUFBUyxNQUFNUCxXQUFXLENBQUNLLEdBQUcsQ0FBQ0csTUFBSixDQUFXQyxLQUFaLENBQVgsQ0FBOEJDLFVBQTlCLEVBQWY7QUFDRCxLQUZELENBRUUsT0FBT0MsR0FBUCxFQUFZO0FBQ1paLE1BQUFBLEVBQUUsQ0FBQ2EsTUFBSCxDQUFVQyxXQUFWLENBQXNCRixHQUF0QixFQUEyQkcsS0FBM0IsQ0FBaUMsc0JBQWpDO0FBQ0FSLE1BQUFBLEdBQUcsQ0FBQ1MsVUFBSixDQUFlLEdBQWY7QUFDRDtBQUNGLEdBUEQ7QUFTQWQsRUFBQUEsTUFBTSxDQUFDZSxJQUFQLENBQVksT0FBWixFQUFxQixPQUFPWCxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDdkMsUUFBSTtBQUNGLFlBQU1OLFdBQVcsQ0FBQ0ssR0FBRyxDQUFDRyxNQUFKLENBQVdDLEtBQVosQ0FBWCxDQUE4QlEsUUFBOUIsQ0FBdUNaLEdBQUcsQ0FBQ2EsSUFBM0MsQ0FBTjtBQUNBWixNQUFBQSxHQUFHLENBQUNTLFVBQUosQ0FBZSxHQUFmO0FBQ0QsS0FIRCxDQUdFLE9BQU9KLEdBQVAsRUFBWTtBQUNaWixNQUFBQSxFQUFFLENBQUNhLE1BQUgsQ0FBVUMsV0FBVixDQUFzQkYsR0FBdEIsRUFBMkJHLEtBQTNCLENBQWlDLHFCQUFqQztBQUNBUixNQUFBQSxHQUFHLENBQUNTLFVBQUosQ0FBZSxHQUFmO0FBQ0Q7QUFDRixHQVJEO0FBVUFkLEVBQUFBLE1BQU0sQ0FBQ0csR0FBUCxDQUFXLFVBQVgsRUFBdUIsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQ3pDLFFBQUk7QUFDRkEsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLEVBQVMsTUFBTVAsV0FBVyxDQUFDSyxHQUFHLENBQUNHLE1BQUosQ0FBV0MsS0FBWixDQUFYLENBQThCVSxXQUE5QixFQUFmO0FBQ0QsS0FGRCxDQUVFLE9BQU9SLEdBQVAsRUFBWTtBQUNaWixNQUFBQSxFQUFFLENBQUNhLE1BQUgsQ0FBVUMsV0FBVixDQUFzQkYsR0FBdEIsRUFBMkJHLEtBQTNCLENBQWlDLCtEQUFqQztBQUNBUixNQUFBQSxHQUFHLENBQUNTLFVBQUosQ0FBZSxHQUFmO0FBQ0Q7QUFDRixHQVBEO0FBUUQsQyIsInNvdXJjZVJvb3QiOiJEOlxcQ29kaWdvIEJvdHByZXNzXFxib3RwcmVzc1xcbW9kdWxlc1xcY29kZS1lZGl0b3JcXHNyY1xcYmFja2VuZCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHNkayBmcm9tICdib3RwcmVzcy9zZGsnXHJcblxyXG5pbXBvcnQgeyBFZGl0b3JCeUJvdCB9IGZyb20gJy4vdHlwaW5ncydcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChicDogdHlwZW9mIHNkaywgZWRpdG9yQnlCb3Q6IEVkaXRvckJ5Qm90KSA9PiB7XHJcbiAgY29uc3Qgcm91dGVyID0gYnAuaHR0cC5jcmVhdGVSb3V0ZXJGb3JCb3QoJ2NvZGUtZWRpdG9yJylcclxuXHJcbiAgcm91dGVyLmdldCgnL2ZpbGVzJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXMuc2VuZChhd2FpdCBlZGl0b3JCeUJvdFtyZXEucGFyYW1zLmJvdElkXS5mZXRjaEZpbGVzKCkpXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgYnAubG9nZ2VyLmF0dGFjaEVycm9yKGVycikuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGZpbGVzJylcclxuICAgICAgcmVzLnNlbmRTdGF0dXMoNTAwKVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIHJvdXRlci5wb3N0KCcvc2F2ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgZWRpdG9yQnlCb3RbcmVxLnBhcmFtcy5ib3RJZF0uc2F2ZUZpbGUocmVxLmJvZHkpXHJcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBicC5sb2dnZXIuYXR0YWNoRXJyb3IoZXJyKS5lcnJvcignQ291bGQgbm90IHNhdmUgZmlsZScpXHJcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDUwMClcclxuICAgIH1cclxuICB9KVxyXG5cclxuICByb3V0ZXIuZ2V0KCcvdHlwaW5ncycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgcmVzLnNlbmQoYXdhaXQgZWRpdG9yQnlCb3RbcmVxLnBhcmFtcy5ib3RJZF0ubG9hZFR5cGluZ3MoKSlcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBicC5sb2dnZXIuYXR0YWNoRXJyb3IoZXJyKS5lcnJvcignQ291bGQgbm90IGxvYWQgdHlwaW5ncy4gQ29kZSBjb21wbGV0aW9uIHdpbGwgbm90IGJlIGF2YWlsYWJsZScpXHJcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDUwMClcclxuICAgIH1cclxuICB9KVxyXG59XHJcbiJdfQ==